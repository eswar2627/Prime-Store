{% extends 'base.html' %}
{% block title %}My Wishlist{% endblock %}

{% block content %}

<style>
/* Prevent card from acting like a clickable link */
.product-card {
    pointer-events: auto !important;
}
.product-card * {
    pointer-events: auto !important;
}
.product-card .btn {
    pointer-events: auto !important;
}
.wishlist-item-card * {
    pointer-events: auto !important;
}
</style>

<h2>My Wishlist</h2>

{% if items %}
  <div class="row mt-3">
    {% for item in items %}
    <div class="col-md-4 mb-4">
      <div class="card product-card h-100 wishlist-item-card">

        {% if item.product.image %}
        <img src="{{ item.product.image.url }}" class="card-img-top" alt="{{ item.product.name }}">
        {% else %}
        <img src="https://via.placeholder.com/300x200" class="card-img-top" alt="No image">
        {% endif %}

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ item.product.name }}</h5>
          <p class="card-text text-muted mb-2">â‚¹{{ item.product.price }}</p>

          <p class="card-text small flex-grow-1">
            {{ item.product.description|truncatechars:80 }}
          </p>

          <div class="mt-auto">

            <!-- VIEW BUTTON -->
            <a href="{{ item.product.get_absolute_url }}"
               class="btn btn-primary btn-sm w-100 mb-2">
                View
            </a>

            <!-- REMOVE BUTTON (POST REQUEST) -->
            <form action="{% url 'store:wishlist_remove' item.product.id %}"
                  method="POST"
                  class="w-100">
                {% csrf_token %}
                <button type="submit"
                        class="btn btn-outline-danger btn-sm w-100">
                    Remove
                </button>
            </form>

          </div>
        </div>

      </div>
    </div>
    {% endfor %}
  </div>

{% else %}

  <div class="alert alert-info mt-3">
    Your wishlist is empty.
    <a href="{% url 'store:product_list' %}">Browse products</a>
  </div>

{% endif %}

{% endblock %}
